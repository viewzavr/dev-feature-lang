неверно рассчитывались сечения.
долго искал ошибку.
оказалось она из кода который я скопипастил из другого места проекта
let discrete_x = Math.floor((x - block.x) / block.stepx);
let discrete_y = Math.floor((x - block.y) / block.stepy);

чтобы такое ловить.. надо какую-то семантическую проверку типов.. чтобы операция - сказала - ребята, вы тут оперируете вещи из разных семантик.
(хоть они оба и число)